# 株一覧画面仕様書

## 1. 画面概要

登録済みの株銘柄の一覧を表示し、各銘柄の詳細情報を確認できる画面。株価チャート画面への遷移や新規銘柄登録画面へのナビゲーションを提供する。

### 1.1 画面URL
- パス: `/stocks`

### 1.2 画面イメージ

（画面モックアップは実装時に追加予定）

---

## 2. 画面項目定義

### 2.1 ヘッダーエリア

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 画面タイトル | テキスト | 「株一覧」を表示 |
| 新規登録ボタン | ボタン | 株登録画面（`/stocks/new`）への遷移ボタン |

### 2.2 株一覧テーブル

| 項目名 | 種別 | 説明 |
|--------|------|------|
| 銘柄コード | テキスト | 4桁の株銘柄コード（例: 7203, 9984） |
| 銘柄名 | テキスト | 株の名称（例: トヨタ自動車、ソフトバンクグループ） |
| 登録日時 | テキスト | 銘柄がシステムに登録された日時 |
| 更新日時 | テキスト | 銘柄情報が最後に更新された日時 |
| アクションボタン | ボタン | 「チャート表示」ボタン - 株価チャート画面（`/chart/:stockCode`）への遷移 |

### 2.3 状態表示

| 項目名 | 種別 | 説明 |
|--------|------|------|
| ローディング表示 | スピナー/テキスト | データ取得中は「読み込み中...」を表示 |
| エラー表示 | エラーメッセージ | API通信エラー時に「株一覧の取得に失敗しました」を表示 |
| データ無し表示 | テキスト | 登録銘柄が0件の場合「登録されている銘柄がありません」を表示 |

---

## 3. 操作処理詳細

### 3.1 初期表示処理

#### 処理概要
画面表示時に登録済みの株銘柄一覧をバックエンドAPIから取得し、テーブル形式で表示する。

#### 処理フロー
1. 画面マウント時に`GET /api/v1/stocks` APIを呼び出す
2. ローディング状態を表示（スピナーまたは「読み込み中...」メッセージ）
3. APIレスポンスを受信
4. 成功時: 株一覧データを画面に表示
5. 失敗時: エラーメッセージを表示
6. データが0件の場合: 「登録されている銘柄がありません」メッセージを表示

#### データ取得API
- **エンドポイント**: `GET /api/v1/stocks`
- **レスポンス形式**:
```typescript
{
  success: true,
  data: {
    stocks: [
      {
        stockId: number,
        stockCode: string,      // 4桁の銘柄コード
        stockName: string,      // 銘柄名
        createdAt: string,      // ISO 8601形式の日時
        updatedAt: string       // ISO 8601形式の日時
      }
    ],
    total: number              // 総件数
  }
}
```

### 3.2 新規登録ボタン押下処理

#### 処理概要
ユーザーが「新規登録」ボタンをクリックすると、株登録画面へ遷移する。

#### 処理フロー
1. ユーザーが「新規登録」ボタンをクリック
2. React Routerを使用して `/stocks/new` へ画面遷移
3. 株登録画面が表示される

### 3.3 チャート表示ボタン押下処理

#### 処理概要
テーブル行のアクションボタンをクリックすると、該当銘柄の株価チャート画面へ遷移する。

#### 処理フロー
1. ユーザーが特定銘柄の「チャート表示」ボタンをクリック
2. クリックされた銘柄の`stockCode`を取得
3. React Routerを使用して `/chart/:stockCode` へ画面遷移
4. 株価チャート画面が表示される

### 3.4 日時フォーマット処理

#### 処理概要
APIから取得した日時データ（ISO 8601形式）を日本語の読みやすい形式に変換して表示する。

#### 処理フロー
1. APIレスポンスの`createdAt`、`updatedAt`を取得（例: `2024-03-15T10:30:00.000Z`）
2. `Date`オブジェクトに変換
3. ロケール対応フォーマット（例: `2024年3月15日 19:30`）に整形
4. テーブルに表示

#### 表示形式
- フォーマット例: `YYYY年MM月DD日 HH:mm`
- タイムゾーン: 日本標準時（JST, UTC+9）

---

## 4. エラーハンドリング

### 4.1 エラー種別

| エラー種別 | 表示メッセージ | 対応 |
|-----------|---------------|------|
| ネットワークエラー | "株一覧の取得に失敗しました" | エラーメッセージを画面上部に表示、リトライボタンを提供 |
| サーバーエラー（5xx） | "サーバーエラーが発生しました" | エラーメッセージを画面上部に表示、リトライボタンを提供 |
| タイムアウトエラー | "通信がタイムアウトしました" | エラーメッセージを画面上部に表示、リトライボタンを提供 |

### 4.2 エラー処理フロー

1. API呼び出し中に例外が発生
2. エラー種別を判定（ネットワーク、サーバー、タイムアウト等）
3. 適切なエラーメッセージをユーザーに表示
4. コンソールに詳細なエラーログを出力（開発者向け）
5. ローディング状態を解除
6. リトライ可能なエラーの場合、「再読み込み」ボタンを表示

### 4.3 リトライ処理

1. ユーザーが「再読み込み」ボタンをクリック
2. エラーメッセージをクリア
3. 初期表示処理（3.1）を再実行
